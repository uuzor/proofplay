<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProofPlay - Decentralized Gaming Oracle</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .tagline {
            font-size: 1.2em;
            opacity: 0.95;
        }

        .demo-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .section-title {
            font-size: 1.8em;
            margin-bottom: 20px;
            color: #667eea;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .flow-diagram {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .flow-step {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            transition: transform 0.3s;
            cursor: pointer;
        }

        .flow-step:hover {
            transform: translateY(-5px);
        }

        .flow-step-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .flow-step-title {
            font-size: 1.1em;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .flow-step-desc {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
            margin: 10px 0;
        }

        .stat-label {
            font-size: 1em;
            color: #666;
        }

        .match-list {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 20px;
        }

        .match-item {
            background: #f8f9fa;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .match-item.win {
            border-left-color: #28a745;
        }

        .match-item.loss {
            border-left-color: #dc3545;
        }

        .match-item.draw {
            border-left-color: #ffc107;
        }

        .match-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .match-id {
            font-weight: bold;
            color: #667eea;
        }

        .match-outcome {
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
        }

        .match-outcome.win {
            background: #d4edda;
            color: #155724;
        }

        .match-outcome.loss {
            background: #f8d7da;
            color: #721c24;
        }

        .match-outcome.draw {
            background: #fff3cd;
            color: #856404;
        }

        .match-details {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            font-size: 0.9em;
            color: #666;
        }

        .log-container {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            max-height: 400px;
            overflow-y: auto;
            margin-top: 20px;
        }

        .log-entry {
            margin-bottom: 8px;
            padding: 5px;
            border-left: 3px solid #667eea;
            padding-left: 10px;
        }

        .log-entry.success {
            border-left-color: #28a745;
        }

        .log-entry.error {
            border-left-color: #dc3545;
        }

        .log-entry.info {
            border-left-color: #17a2b8;
        }

        .highlight {
            background: rgba(102, 126, 234, 0.1);
            padding: 2px 5px;
            border-radius: 3px;
            font-weight: bold;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .tech-stack {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .tech-badge {
            background: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
            color: #667eea;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üéÆ ProofPlay</h1>
            <p class="tagline">Decentralized Gaming Oracle & Prediction Market Data Layer</p>
            <div class="tech-stack">
                <span class="tech-badge">‚ö° Sui</span>
                <span class="tech-badge">ü¶≠ Walrus</span>
                <span class="tech-badge">üîí Seal</span>
                <span class="tech-badge">üåä Nautilus</span>
            </div>
        </header>

        <!-- How It Works -->
        <div class="demo-section">
            <h2 class="section-title">üìã How It Works</h2>
            <div class="flow-diagram">
                <div class="flow-step">
                    <div class="flow-step-number">1</div>
                    <div class="flow-step-title">Play Game</div>
                    <div class="flow-step-desc">Player completes PvP match</div>
                </div>
                <div class="flow-step">
                    <div class="flow-step-number">2</div>
                    <div class="flow-step-title">Generate Proof</div>
                    <div class="flow-step-desc">Create cryptographic proof</div>
                </div>
                <div class="flow-step">
                    <div class="flow-step-number">3</div>
                    <div class="flow-step-title">Store on Walrus</div>
                    <div class="flow-step-desc">Upload to decentralized storage</div>
                </div>
                <div class="flow-step">
                    <div class="flow-step-number">4</div>
                    <div class="flow-step-title">Submit to Sui</div>
                    <div class="flow-step-desc">Record on blockchain</div>
                </div>
                <div class="flow-step">
                    <div class="flow-step-number">5</div>
                    <div class="flow-step-title">Markets Query</div>
                    <div class="flow-step-desc">Prediction markets pay for data</div>
                </div>
                <div class="flow-step">
                    <div class="flow-step-number">6</div>
                    <div class="flow-step-title">Earn Revenue</div>
                    <div class="flow-step-desc">Players get paid per query</div>
                </div>
            </div>
        </div>

        <!-- Demo Controls -->
        <div class="demo-section">
            <h2 class="section-title">üéØ Interactive Demo</h2>
            <div class="controls">
                <button id="playMatchBtn" onclick="playMatch()">üéÆ Play Match</button>
                <button id="autoPlayBtn" onclick="autoPlay()">‚ö° Auto Play (3 matches)</button>
                <button id="queryDataBtn" onclick="queryData()">üîç Query Match Data</button>
                <button id="clearBtn" onclick="clearData()">üóëÔ∏è Clear All</button>
            </div>

            <!-- Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Total Matches</div>
                    <div class="stat-value" id="totalMatches">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Win Rate</div>
                    <div class="stat-value" id="winRate">0%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Queries</div>
                    <div class="stat-value" id="totalQueries">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Revenue Earned</div>
                    <div class="stat-value" id="revenue">0 SUI</div>
                </div>
            </div>

            <!-- Activity Log -->
            <h3 style="margin-top: 30px; color: #667eea;">üìú Activity Log</h3>
            <div class="log-container" id="activityLog">
                <div class="log-entry info">Ready to start. Click "Play Match" to begin.</div>
            </div>
        </div>

        <!-- Match History -->
        <div class="demo-section">
            <h2 class="section-title">üìä Match History</h2>
            <div class="match-list" id="matchList">
                <p style="text-align: center; color: #999; padding: 40px;">No matches played yet. Start playing to see your history!</p>
            </div>
        </div>
    </div>

    <script>
        // Demo state
        let matches = [];
        let totalQueries = 0;
        let totalRevenue = 0;

        // Mock player address
        const playerAddress = '0x1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef';

        function addLog(message, type = 'info') {
            const log = document.getElementById('activityLog');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.innerHTML = `<span style="opacity: 0.5;">[${new Date().toLocaleTimeString()}]</span> ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        function updateStats() {
            document.getElementById('totalMatches').textContent = matches.length;

            const wins = matches.filter(m => m.outcome === 1).length;
            const winRate = matches.length > 0 ? ((wins / matches.length) * 100).toFixed(1) : 0;
            document.getElementById('winRate').textContent = winRate + '%';

            document.getElementById('totalQueries').textContent = totalQueries;
            document.getElementById('revenue').textContent = totalRevenue.toFixed(2) + ' SUI';
        }

        function generateMatchId() {
            return `match_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
        }

        function generateBlobId(data) {
            // Simple hash function for demo
            let hash = 0;
            const str = JSON.stringify(data);
            for (let i = 0; i < str.length; i++) {
                hash = ((hash << 5) - hash) + str.charCodeAt(i);
                hash = hash & hash;
            }
            return Math.abs(hash).toString(16).padStart(16, '0');
        }

        async function playMatch() {
            const btn = document.getElementById('playMatchBtn');
            btn.disabled = true;
            btn.innerHTML = '<span class="loading"></span> Playing...';

            addLog('üéÆ Starting new match...', 'info');

            // Simulate match
            await sleep(500);
            const outcome = Math.floor(Math.random() * 3); // 0=loss, 1=win, 2=draw
            const outcomeText = outcome === 1 ? 'WIN' : outcome === 0 ? 'LOSS' : 'DRAW';

            const matchData = {
                matchId: generateMatchId(),
                gameId: 'CS2',
                playerAddress: playerAddress,
                opponentAddress: '0x' + Math.random().toString(16).substr(2, 8),
                outcome: outcome,
                kills: Math.floor(Math.random() * 30),
                deaths: Math.floor(Math.random() * 30),
                score: Math.floor(Math.random() * 10000),
                timestamp: Date.now(),
            };

            addLog(`‚öîÔ∏è Match completed: <span class="highlight">${outcomeText}</span> - ${matchData.kills}K/${matchData.deaths}D`, 'info');

            // Generate proof
            await sleep(300);
            addLog('üîê Generating cryptographic proof...', 'info');
            const proofHash = generateBlobId(matchData);

            // Upload to Walrus
            await sleep(500);
            const blobId = generateBlobId(matchData);
            matchData.walrusBlobId = blobId;
            addLog(`üì§ Uploaded to Walrus: <span class="highlight">${blobId.substr(0, 16)}...</span>`, 'success');

            // Submit to blockchain
            await sleep(400);
            const txHash = '0x' + Math.random().toString(16).substr(2, 16);
            matchData.txHash = txHash;
            addLog(`‚õìÔ∏è Submitted to Sui: <span class="highlight">${txHash.substr(0, 16)}...</span>`, 'success');

            // Save match
            matches.push(matchData);
            updateStats();
            renderMatches();

            addLog('‚úÖ Match recorded successfully on-chain!', 'success');

            btn.disabled = false;
            btn.innerHTML = 'üéÆ Play Match';
        }

        async function autoPlay() {
            const btn = document.getElementById('autoPlayBtn');
            btn.disabled = true;
            btn.innerHTML = '<span class="loading"></span> Auto Playing...';

            addLog('‚ö° Starting auto-play mode (3 matches)...', 'info');

            for (let i = 1; i <= 3; i++) {
                addLog(`--- Match ${i}/3 ---`, 'info');
                await playMatch();
                if (i < 3) await sleep(800);
            }

            addLog('üéâ Auto-play complete!', 'success');

            btn.disabled = false;
            btn.innerHTML = '‚ö° Auto Play (3 matches)';
        }

        async function queryData() {
            if (matches.length === 0) {
                addLog('‚ùå No matches available to query', 'error');
                return;
            }

            const btn = document.getElementById('queryDataBtn');
            btn.disabled = true;
            btn.innerHTML = '<span class="loading"></span> Querying...';

            const match = matches[Math.floor(Math.random() * matches.length)];

            addLog('üîç Prediction market querying match data...', 'info');

            // Simulate query
            await sleep(400);
            addLog(`üì• Retrieved proof from Walrus: <span class="highlight">${match.matchId}</span>`, 'info');

            await sleep(300);
            const queryPayment = 0.05; // 0.05 SUI per query
            addLog(`üí∞ Payment received: <span class="highlight">${queryPayment} SUI</span>`, 'success');

            // Distribute revenue
            await sleep(200);
            const playerShare = queryPayment * 0.7; // 70% to player
            totalRevenue += playerShare;
            totalQueries++;

            addLog(`üí∏ Revenue distributed: <span class="highlight">${playerShare.toFixed(3)} SUI</span> to player`, 'success');

            updateStats();

            btn.disabled = false;
            btn.innerHTML = 'üîç Query Match Data';
        }

        function clearData() {
            matches = [];
            totalQueries = 0;
            totalRevenue = 0;
            updateStats();
            renderMatches();
            document.getElementById('activityLog').innerHTML = '<div class="log-entry info">Data cleared. Ready to start fresh!</div>';
        }

        function renderMatches() {
            const listEl = document.getElementById('matchList');

            if (matches.length === 0) {
                listEl.innerHTML = '<p style="text-align: center; color: #999; padding: 40px;">No matches played yet. Start playing to see your history!</p>';
                return;
            }

            listEl.innerHTML = matches.slice().reverse().map(match => {
                const outcomeClass = match.outcome === 1 ? 'win' : match.outcome === 0 ? 'loss' : 'draw';
                const outcomeText = match.outcome === 1 ? 'WIN' : match.outcome === 0 ? 'LOSS' : 'DRAW';

                return `
                    <div class="match-item ${outcomeClass}">
                        <div class="match-header">
                            <span class="match-id">${match.matchId}</span>
                            <span class="match-outcome ${outcomeClass}">${outcomeText}</span>
                        </div>
                        <div class="match-details">
                            <div><strong>K/D:</strong> ${match.kills}/${match.deaths}</div>
                            <div><strong>Score:</strong> ${match.score}</div>
                            <div><strong>Blob:</strong> ${match.walrusBlobId.substr(0, 8)}...</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // Initialize
        updateStats();
    </script>
</body>
</html>
